name: Java Build

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up JDK 11
      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
    
    - name: Check project structure
      run: |
        echo "ğŸ“ Project structure:"
        find . -type f -name "*.java" | head -10
        ls -la networksubnettingautomation/
    
    - name: Compile Java files
      run: |
        echo "ğŸ”¨ Compiling Java source files..."
        javac networksubnettingautomation/*.java
        
        if [ $? -eq 0 ]; then
          echo "âœ… Compilation successful!"
          echo "Generated $(find networksubnettingautomation -name "*.class" | wc -l) class files"
        else
          echo "âŒ Compilation failed!"
          exit 1
        fi
    
    - name: Create executable script
      run: |
        cat > run.sh << 'EOF'
        #!/bin/bash
        echo "Starting Network Subnetting Automation..."
        java networksubnettingautomation.SubnettingGUI
        EOF
        chmod +x run.sh
        echo "ğŸ“„ Created run.sh script"
    
    - name: Test run (optional)
      run: |
        echo "Testing if application starts..."
        timeout 5s java networksubnettingautomation.SubnettingGUI || true
